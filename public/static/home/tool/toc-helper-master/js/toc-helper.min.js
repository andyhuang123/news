/*!
Date Sun Apr 07 2019 21:08:39 GMT+0800 (GMT+08:00) 
Version 1.1.1 
Copyright © 2018-2019 Design By xiaolang
*/
!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):(t=t||self).TocHelper=i()}(this,function(){"use strict";var t=document,i=window,n=t.body,s=t.querySelector.bind(t),e=t.querySelectorAll.bind(t),h=(i.requestAnimationFrame,/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)),r=h?"touchstart":"mouseenter",o=h?"touchend":"mouseleave",f=h?"touchend":"click",c=h?"orientationchange":"resize",u="vertical",a="horizontal",l=function(t){return t instanceof HTMLElement},v=function(t){return"string"==typeof t},d=function(t){return"[object Object]"===Object.prototype.toString.call(t)},m=function(t){var n=function(t,n,s){if(t&&!s)return i.getComputedStyle(t).getPropertyValue(n);t.style[n]=s}(t,"position");return n&&"static"!==n},g=t.documentElement.clientHeight,p="toc",y="*[data-toc]",b={dom:y,classNames:{toc:p,fxied:"".concat(p,"-fixed"),brand:"".concat(p,"-brand"),navbar:"".concat(p,"-navbar"),hightlight:"".concat(p,"-hightlight"),nav:"".concat(p,"-nav"),link:"".concat(p,"-link"),active:"active",marginLeft1:"ml-1",marginLeft2:"ml-2",marginLeft3:"ml-3",marginLeft4:"ml-4",marginLeft5:"ml-5",marginLeft6:"ml-6"},hightlight:!0,brand:"目录",t:"shadow",idPrefix:"toc-heading-",offsetBody:n,tocFixed:{top:24,left:0},maxDepth:6,autoScroll:!0},x=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b;return v(t)||l(t)?i.dom=t:d(t)&&(i=t),this.options=Object.assign({},b,i),this.megre(),this.i(),this};x.prototype={megre:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(d(t)){if(this.options=Object.assign({},this.options,t),v(this.options.dom)&&(this.options.dom=s(this.options.dom)||s(y)),!this.options.dom||!l(this.options.dom))throw new Error("Not found any content, Please sure this dom is exist");var i;this.options.maxDepth=(i=parseInt(this.options.maxDepth||6))>=1&&i<=6?i:6;var e=this.options.offsetBody;if(e&&e!==n)if(l(e))this.options.offsetBody=m(e)?e:n;else if(v(e)){var h=function(t){try{return s(t)}catch(t){return null}}(e);this.options.offsetBody=h&&h!==n&&m(e)?h:n}else this.options.offsetBody=n;else this.options.offsetBody=n;this.toc=s(this.options.dom.dataset.toc)||s(".".concat(this.options.classNames.toc));var r=this.toc&&this.toc.classList;return r&&!r.contains(this.options.classNames.toc)&&r.add(this.options.classNames.toc),this}},reload:function(){this.hightlight=!0===this.options.hightlight?s(".".concat(this.options.classNames.hightlight)):null,this.navbar=this.navbar||s(".".concat(this.options.classNames.navbar)),this.s(),this.fixed(),this.t(),!this.elements&&(this.elements=this.h()),this.events=[this.o.bind(this)],this.u(),this.l(),this.v(),this.m()},i:function(){var n=this;i.addEventListener(c,function(){g=t.documentElement.clientHeight,n.g(n.m,200).call(n)})},m:function(){this.p();var t=this.options.tocFixed,i=this.navbar;if(this.options.autoScroll&&t&&this.toc.offsetHeight+(t.top||0)>g){var n=g-this.S(i)-(t.top||0);i.style.maxHeight=n+"px",i.style.overflowY="auto"}},p:function(){this.navbar.style.maxHeight="inherit",this.navbar.style.overflowY="inherit"},v:function(){var t=this.navbar,i=this.active;if(i&&function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;return i===u?t.scrollHeight>t.clientHeight:i===a&&t.scrollWidth>t.clientWidth}(t)){var n=i.offsetTop;t.scrollTo(0,n)}},o:function(){this.l(),this.v()},O:function(){(this.options.offsetBody===n?i:this.options.offsetBody).addEventListener("scroll",this.events[0])},L:function(){(this.options.offsetBody===n?i:this.options.offsetBody).removeEventListener("scroll",this.events[0])},u:function(){this.L(),this.g(this.O,200).call(this)},reset:function(){this.clear();var i=t.createDocumentFragment(),n=this.elements=this.h(),s=n.targets,e=n.levels;if("string"==typeof this.options.brand){var h=t.createElement("div");h.classList.add(this.options.classNames.brand),h.textContent=this.options.brand,i.appendChild(h)}var r=t.createElement("div");if(r.classList.add(this.options.classNames.navbar),i.appendChild(r),this.navbar=r,!0===this.options.hightlight){var o=t.createElement("div");o.classList.add(this.options.classNames.hightlight),r.appendChild(o)}var f=this.options.classNames.nav,c=null,u=1;e.forEach(function(i,n,e){var h=s[n];if(h)if(0===n||e[n-1]!==i){var o=t.createElement("nav");if(o.classList.add(f),o.appendChild(h),1===i)r.appendChild(o);else if(i>=u)c.appendChild(o);else{for(var a=c.parentNode,l=0;l<u-i-1;l++)a=a.parentNode;a&&a.appendChild(o)}c=o,u=i}else c.appendChild(h)}),this.toc.appendChild(i),this.reload()},T:function(){var s=this.options.offsetBody;return s===i?s.pageYOffset:s===n?t.documentElement.scrollTop||n.scrollTop:s.scrollTop},P:function(){var t=0,i=this.options.idPrefix;return{next:function(){return t++,{value:"".concat(i).concat(t)}}}},g:function(t,i){return function(){var n=this,s=arguments;t.timer&&clearTimeout(t.timer),t.timer=setTimeout(function(){t.apply(n,s)},i)}},empty:function(t){if(t&&l(t))for(;t.lastChild;)t.removeChild(t.lastChild)},clear:function(){this.empty(this.toc),this.elements=null},l:function(){var t=this.elements,i=t.offsets,n=t.targets,s=this.T(),e=n[i.findIndex(function(t){return Number(t)>s})];e&&this.setActive(e)},S:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n,s=t.offsetTop;return t.offsetParent&&t.offsetParent!==i&&(s+=this.S(t.offsetParent)),s},h:function(){var i=this,n=this.options.maxDepth,s=n,h=Array.from(this.options.dom.querySelectorAll(["h1","h2","h3","h4","h5","h6"].slice(0,n).join(","))||[]),r=this.P();h.forEach(function(n,h,o){var f=function(t,i,n){if(n<=1||0===i)return 1;if(n>s)return s;for(var e=t.filter(function(t,n){return n<i}),h=e.length-1;h>=0;h--){var r=e[h][1],o=+e[h][3].nodeName[1];if(n<o)return n>r?r:n;if(n===o)return r;if(o<n)return r+1}}(o,h,+n.nodeName[1]),c=i.S(n,i.options.offsetBody);!function(t){t.id&&1===e("#".concat(t.id)).length||(t.id=r.next().value)}(n);var u=function(n,s){if(!n.textContent.replace(/\s/g,""))return!1;var e=i.toc.querySelector('a[href="#'.concat(n.id,'"]'));return e||((e=t.createElement("a")).href="#".concat(n.id),e.classList.add(i.options.classNames.link),s>=2&&e.classList.add("".concat(i.options.classNames["marginLeft".concat(s-1)])),e.textContent=n.textContent),e}(n,f);o.splice(h,1,[h,f,c,n,u])});var o={levels:[],offsets:[],sources:[],targets:[]};return h.forEach(function(t,i){o.levels[i]=t[1],o.offsets[i]=t[2],o.sources[i]=t[3],o.targets[i]=t[4]}),o},setActive:function(t){var i=this.active,n=i?i.classList:[],e=this.options.classNames.active,h=".".concat(this.options.classNames.link,".").concat(this.options.classNames.active);i&&n.contains(e)&&n.remove(e),n=(i=this.active=t&&l(t)?t:s(h))&&(i.classList||[]),i&&!n.contains(e)&&n.add(e),this.j(i)},j:function(t){this.hightlight&&(t?(this.hightlight.style.top=t.offsetTop+"px",this.hightlight.style.height=t.offsetHeight+"px"):(this.hightlight.style.top=0,this.hightlight.style.height=0))},B:function(t){this.j(t.target)},_:function(){this.setActive(this.active)},A:function(t){this.u(),this.setActive(t.target)},s:function(){if(this.hightlight){var t=this;Array.from(e(".".concat(this.options.classNames.toc," .").concat(this.options.classNames.link))||[]).forEach(function(i){i.addEventListener(r,t.B.bind(t)),i.addEventListener(o,t._.bind(t)),i.addEventListener(f,t.A.bind(t))})}},t:function(){if(!1!==this.options.t){var t=this.toc,i=t&&(t.classList||[]),n=this.options.t;!i.contains(n)&&i.add(n)}},fixed:function(){var t=this.toc,i=this.options.tocFixed;if(t){var n=this.options.classNames.fxied,s=t.classList;!1===i?(t.style.top="inherit",t.style.left="inherit",s.contains(n)&&s.remove(n)):(!s.contains(n)&&s.add(n),i.top&&(t.style.top=i.top+"px"),i.left&&(t.style.left=i.left+"px"))}}};var S=x,w=x;return S.default=w,S});
